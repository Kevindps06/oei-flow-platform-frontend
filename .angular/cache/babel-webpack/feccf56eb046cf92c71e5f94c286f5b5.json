{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { Utils } from 'src/app/classes/utils';\nimport { HttpEventType } from '@angular/common/http';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/forms.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\n\nfunction FormsJuridicaContratacionConvenioRequestComponent_div_28_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵelementStart(1, \"div\", 19);\n    i0.ɵɵelementStart(2, \"h5\", 20);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 21);\n    i0.ɵɵelementStart(5, \"a\", 22);\n    i0.ɵɵelementStart(6, \"img\", 23);\n    i0.ɵɵlistener(\"click\", function FormsJuridicaContratacionConvenioRequestComponent_div_28_div_1_Template_img_click_6_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const adjuntosFile_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return ctx_r3.whenDeleteFileAdjuntosClick(adjuntosFile_r2.Index);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const adjuntosFile_r2 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", adjuntosFile_r2.Index, \". \", adjuntosFile_r2.Name, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵpropertyInterpolate(\"src\", adjuntosFile_r2.Uploaded ? \"../../../../assets/delete.png\" : \"../../../../assets/loading.svg\", i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction FormsJuridicaContratacionConvenioRequestComponent_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtemplate(1, FormsJuridicaContratacionConvenioRequestComponent_div_28_div_1_Template, 7, 3, \"div\", 17);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.adjuntosFiles);\n  }\n}\n\nconst _c0 = function (a0, a1) {\n  return {\n    \"is-valid\": a0,\n    \"is-invalid\": a1\n  };\n};\n\nexport let FormsJuridicaContratacionConvenioRequestComponent = /*#__PURE__*/(() => {\n  class FormsJuridicaContratacionConvenioRequestComponent {\n    constructor(formsService) {\n      this.formsService = formsService;\n      this.waitTasks = [];\n      this.adjuntosFiles = [];\n      this.onWaitTasksChange = new EventEmitter();\n    }\n\n    ngOnInit() {}\n\n    whenFileAdjuntosChange(event) {\n      let currentFilesLength = this.adjuntosFiles.length;\n\n      for (let i = 0; event.target.files.length > i; i++) {\n        this.adjuntosFiles.push({\n          Index: currentFilesLength + i,\n          Name: event.target.files[i].name,\n          Size: event.target.files[i].size,\n          Type: event.target.files[i].type,\n          Uploaded: false\n        });\n        Utils.getBase64(event.target.files[i]).then(result => {\n          this.adjuntosFiles[currentFilesLength + i].Bytes = result;\n          this.adjuntosFiles[currentFilesLength + i].Uploaded = true;\n        });\n      }\n\n      event.target.value = null;\n    }\n\n    whenDeleteFileAdjuntosClick(index) {\n      if (this.adjuntosFiles[index].Uploaded === true) {\n        this.adjuntosFiles.splice(index, 1);\n\n        for (let i = 0; this.adjuntosFiles.length > i; i++) {\n          this.adjuntosFiles[i].Index = i;\n        }\n      }\n    }\n\n    whenSubmit() {\n      const formsJuridicaContratacionConvenio = {\n        id: Utils.makeRandomString(64),\n        operation: 'juridica-contratacion-convenio',\n        username: 'aescobar@contratista.oei.org.co',\n        password: '',\n        number: this.numero,\n        name: this.nombre,\n        filesFields: [{\n          key: \"Adjuntos\",\n          value: this.adjuntosFiles\n        }],\n        additionalInfo: '',\n        keys: [\"id\", \"operation\", \"username\", \"password\", \"number\", \"name\", \"filesFields\"]\n      };\n      var taskId;\n      this.formsService.postFormsJuridicaContratacionConvenioRequest(formsJuridicaContratacionConvenio).subscribe(event => {\n        switch (event.type) {\n          case HttpEventType.Sent:\n            taskId = Utils.makeRandomString(4);\n            this.waitTasks.push({\n              id: taskId,\n              description: 'Enviando información...',\n              total: 0,\n              current: 0,\n              progress: 0\n            });\n            this.onWaitTasksChange.emit(this.waitTasks);\n            break;\n\n          case HttpEventType.UploadProgress:\n            let taskIndex = this.waitTasks.findIndex(element => element.id === taskId);\n            this.waitTasks[taskIndex].total = event.total;\n            this.waitTasks[taskIndex].current = event.loaded;\n            this.waitTasks[taskIndex].progress = Math.round(event.loaded * 100 / event.total);\n            this.onWaitTasksChange.emit(this.waitTasks);\n            break;\n\n          case HttpEventType.Response:\n            this.waitTasks.splice(this.waitTasks.findIndex(element => element.id === taskId), 1);\n            this.onWaitTasksChange.emit(this.waitTasks);\n            break;\n        }\n      });\n    }\n\n  }\n\n  FormsJuridicaContratacionConvenioRequestComponent.ɵfac = function FormsJuridicaContratacionConvenioRequestComponent_Factory(t) {\n    return new (t || FormsJuridicaContratacionConvenioRequestComponent)(i0.ɵɵdirectiveInject(i1.FormsService));\n  };\n\n  FormsJuridicaContratacionConvenioRequestComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FormsJuridicaContratacionConvenioRequestComponent,\n    selectors: [[\"app-forms-juridica-contratacion-convenio-request\"]],\n    inputs: {\n      convenios: \"convenios\"\n    },\n    outputs: {\n      onWaitTasksChange: \"onWaitTasksChange\"\n    },\n    decls: 33,\n    vars: 9,\n    consts: [[1, \"was-validated\", 3, \"ngSubmit\"], [1, \"row\", \"g-3\"], [1, \"col-12\"], [1, \"form-floating\"], [\"type\", \"text\", \"id\", \"inputTextNumero\", \"name\", \"inputTextNumero\", \"placeholder\", \"x\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"inputTextNumero\"], [1, \"text-danger\"], [1, \"invalid-feedback\"], [\"type\", \"text\", \"id\", \"inputTextNombre\", \"name\", \"inputTextNombre\", \"placeholder\", \"x\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"inputTextNombre\"], [\"for\", \"formFileMultipleAdjuntos\", 1, \"form-label\"], [\"accept\", \"text/csv, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document, image/jpeg, image/png, application/pdf, application/vnd.ms-powerpoint, application/vnd.openxmlformats-officedocument.presentationml.presentation, text/plain, application/vnd.visio, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/xml, text/xml\", \"type\", \"file\", \"id\", \"formFileMultipleAdjuntos\", \"multiple\", \"\", 1, \"form-control\", 3, \"ngClass\", \"required\", \"change\"], [\"class\", \"container\", 4, \"ngIf\"], [1, \"row-12\"], [1, \"d-grid\", \"gap-2\", \"col-xl-6\", \"mx-auto\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [1, \"container\"], [\"class\", \"\\n            row\\n            justify-content-center\\n            align-items-center\\n            mt-3\\n            border-start border-top border-primary border-1\\n          \", 4, \"ngFor\", \"ngForOf\"], [1, \"row\", \"justify-content-center\", \"align-items-center\", \"mt-3\", \"border-start\", \"border-top\", \"border-primary\", \"border-1\"], [1, \"col-11\"], [1, \"mb-0\"], [1, \"col-1\", \"gx-0\"], [\"href\", \"javascript:;\"], [\"width\", \"50px\", \"height\", \"50px\", 1, \"img-fluid\", 3, \"src\", \"click\"]],\n    template: function FormsJuridicaContratacionConvenioRequestComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function FormsJuridicaContratacionConvenioRequestComponent_Template_form_ngSubmit_0_listener() {\n          return ctx.whenSubmit();\n        });\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"input\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function FormsJuridicaContratacionConvenioRequestComponent_Template_input_ngModelChange_4_listener($event) {\n          return ctx.numero = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"label\", 5);\n        i0.ɵɵtext(6, \"Numero del convenio\");\n        i0.ɵɵelementStart(7, \"span\", 6);\n        i0.ɵɵtext(8, \"*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 7);\n        i0.ɵɵtext(10, \" Este campo es (*) obligatorio, rellenelo. \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 2);\n        i0.ɵɵelementStart(12, \"div\", 3);\n        i0.ɵɵelementStart(13, \"input\", 8);\n        i0.ɵɵlistener(\"ngModelChange\", function FormsJuridicaContratacionConvenioRequestComponent_Template_input_ngModelChange_13_listener($event) {\n          return ctx.nombre = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"label\", 9);\n        i0.ɵɵtext(15, \"Nombre del convenio\");\n        i0.ɵɵelementStart(16, \"span\", 6);\n        i0.ɵɵtext(17, \"*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"div\", 7);\n        i0.ɵɵtext(19, \" Este campo es (*) obligatorio, rellenelo. \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\", 2);\n        i0.ɵɵelementStart(21, \"label\", 10);\n        i0.ɵɵtext(22, \"Adjuntos\");\n        i0.ɵɵelementStart(23, \"span\", 6);\n        i0.ɵɵtext(24, \"*\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"input\", 11);\n        i0.ɵɵlistener(\"change\", function FormsJuridicaContratacionConvenioRequestComponent_Template_input_change_25_listener($event) {\n          return ctx.whenFileAdjuntosChange($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"div\", 7);\n        i0.ɵɵtext(27, \" Este campo es (*) obligatorio, cargue almenos 1 archivo. \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(28, FormsJuridicaContratacionConvenioRequestComponent_div_28_Template, 2, 1, \"div\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"div\", 13);\n        i0.ɵɵelementStart(30, \"div\", 14);\n        i0.ɵɵelementStart(31, \"button\", 15);\n        i0.ɵɵtext(32, \" Enviar \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.numero);\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngModel\", ctx.nombre);\n        i0.ɵɵadvance(12);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(6, _c0, ctx.adjuntosFiles.length > 0, ctx.adjuntosFiles.length === 0))(\"required\", ctx.adjuntosFiles.length === 0);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.adjuntosFiles.length > 0);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", true);\n      }\n    },\n    directives: [i2.ɵNgNoValidate, i2.NgControlStatusGroup, i2.NgForm, i2.DefaultValueAccessor, i2.RequiredValidator, i2.NgControlStatus, i2.NgModel, i3.NgClass, i3.NgIf, i3.NgForOf],\n    styles: [\"\"]\n  });\n  return FormsJuridicaContratacionConvenioRequestComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}